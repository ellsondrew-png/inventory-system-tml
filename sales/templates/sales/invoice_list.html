{% extends 'inventory_app/base.html' %}
{% load humanize %}


{% block content %}
<div class="container-fluid">

  <!-- Page Heading -->
<div class="mb-4">
  <h1 class="h3 text-gray-800">Invoices</h1>
  <a href="{% url 'sales:invoice_create' %}" class="btn btn-primary btn-sm mt-2">
    <i class="fas fa-plus"></i> Add Invoice
  </a>
</div>



  <!-- Invoice Table -->
  <div class="card shadow mb-4">
    <div class="card-header py-3">
      <h6 class="m-0 font-weight-bold text-primary">Invoice List</h6>
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-bordered" id="invoiceTable" width="100%" cellspacing="0">
          <thead>
            <tr>
              <th>Invoice Number</th>
              <th>Client</th>
              <th>Date</th>
              <th>Subtotal</th>
              <th>Tax</th>
              <th>Total</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for invoice in invoices %}
            <tr>
              <td>{{ invoice.invoice_number }}</td>
              <td>{{ invoice.client.name }}</td>
              <td>{{ invoice.date|date:"d M Y" }}</td>
              <td>{{ invoice.subtotal|floatformat:2|intcomma }}</td>
              <td>{{ invoice.tax|floatformat:2|intcomma }}</td>
              <td>{{ invoice.total|floatformat:2|intcomma }}</td>
              <td>
                <a href="{% url 'sales:invoice_detail' invoice.id %}" class="btn btn-info btn-sm">
                  <i class="fas fa-eye"></i> View
                </a>
                <a href="{% url 'sales:invoice_edit' invoice.id %}" class="btn btn-warning btn-sm">
                  <i class="fas fa-edit"></i> Edit
                </a>
                <form action="{% url 'sales:invoice_delete' invoice.id %}" method="POST" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-danger btn-sm">
                    <i class="fas fa-trash"></i> Delete
                  </button>
                </form>
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="7" class="text-center">No invoices found.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
  // Optional: DataTables initialization
  $(document).ready(function() {
    $('#invoiceTable').DataTable({
      "ordering": true,
      "order": [[2, "desc"]],  // order by date descending
    });
  });
</script>
{% endblock %}
